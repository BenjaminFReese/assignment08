---
title: "Assignment 08"
author: "Benjamin Reese"
format: html
---

### Packages
```{r packages}
## Loading in Packages
library(readr)
library(tidyverse)
library(tidymodels)
```

## Exercise 01

### (a)

```{r loading and cleaning votes, message=FALSE, warning=FALSE}
## Loading in Data
votes_time_series <- read_csv("data/votes_time_series.csv")

## Replacing NAs with 0s
votes_103 <- votes_time_series %>%
  mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
  filter(session==103)
View(votes_103)

```

### (b)

```{r votes recipe}
## Creating the Recipe for PCA
votes_pca_rec <- recipe(~ ., data = votes_103) %>%
  step_nzv(all_predictors()) %>%
  step_normalize(all_numeric_predictors()) %>% # center and scale (normalize) all predictors
  step_pca(all_numeric_predictors(), num_comp = 3) %>%   # only keep three components
  prep()  # run prep to prepare recipe

```

### (c)

```{r votes variance}
## Checking the variance
tidy(votes_pca_rec, number = 3, type = "variance")

## Obtaining Loadings
tidy(votes_pca_rec, number = 3, type = "coef")
```

### (d)

```{r votes plots, message=FALSE, warning=FALSE}
## Baking
votes_pca_rec %>%
  bake(new_data = NULL) %>%
  ggplot(aes(x=PC1, y=PC2, color=party)) +
  geom_point() +
  scale_color_manual(values = c("D" = "blue", "R"= "red")) +
  theme_minimal()

## Loading in states region data
states_regions <- read_csv("data/states_regions.csv")


```

